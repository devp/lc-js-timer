<html>
<head>
<script src="https://code.jquery.com/jquery-2.1.4.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.js" type="text/javascript"></script>
<script src="lc-js-timer.js" type="text/javascript"></script>
<!-- <script src="lc-js-timer_test.js" type="text/javascript"></script> -->
<link rel="stylesheet" type="text/css" href="styles.css">
<script>
$(function(){
	var T = {};
	T.timer = Handlebars.compile($("#timer-template").html());

	var app = new LcJsTimerApp({
		onStateChange: function(domain, oldState, newState) {
			if (domain == 'game') {
				$("body").toggleClass(
					"game-started",
					((newState == LcJsTimerApp.STATES_ENUM.IN_PROGRESS) ||
					 (newState == LcJsTimerApp.STATES_ENUM.PAUSED)));
				$("body").toggleClass(
					"game-paused",
					(newState == LcJsTimerApp.STATES_ENUM.PAUSED));				
			}
			if (domain == 'travel') {
				$("body").toggleClass(
					"game-travelling",
					((newState == LcJsTimerApp.STATES_TRAVEL_ENUM.TRAVEL_TRANSIT) ||
					 (newState == LcJsTimerApp.STATES_TRAVEL_ENUM.TRAVEL_ARRIVED)));		
			}
		},
		onGameTimerTick: function(seconds) {
			$("#game-timer").html(T.timer(Util.secondsToMinutesAndSecondsAsPaddedStrings(seconds)))
		},
		onTravelTimerTick: function(seconds) {
			$("#travel-timer").html(T.timer(Util.secondsToMinutesAndSecondsAsPaddedStrings(seconds)))
		}
	});
	$("#start-game").click(app.promptAndConfirmAndStartGameTimer.bind(app));
	$("#start-travel").click(app.promptAndConfirmAndPrimeTravelTimer.bind(app));
	$("#stop-travel").click(app.confirmStopTravelTimer.bind(app));
	$("#pause").click(app.pauseGame.bind(app));
	$("#resume").click(app.resumeGame.bind(app));
});
</script>
</head>
<body>
	<div id="game-timer">
	</div>
	<div id="travel-timer">
	</div>
	<div id="controls">
		<button id="start-game" class="show-unless-game-started">Start Game</button>
		<div class="show-if-game-started">
			<button id="start-travel" class="show-unless-game-travelling">Start Travel</button>
			<button id="stop-travel" class="show-if-game-travelling">Stop Travel (DEBUG)</button>
		</div>
		<div class="show-if-game-started">
			<button id="pause" class="show-unless-game-paused">Pause</button>
			<button id="resume" class="show-if-game-paused">Resume</button>
		</div>
	</div>

	<script id="timer-template" type="text/x-handlebars-template">
	  {{minutes}}:{{seconds}}
	</script>
</body>
</html>